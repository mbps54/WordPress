### CREATE AWS ACCOUNT ###
Create AWS account
Create IAM user "artem"
Save Access key ID and Secret access key
Create IAM group "devops" with only needed Policies:
  AmazonRDSFullAccess	AWS managed
  AmazonEC2FullAccess	AWS managed
  SecretsManagerReadWrite	AWS managed
  IAMFullAccess	AWS managed
  ElasticLoadBalancingFullAccess	AWS managed
  AmazonS3FullAccess	AWS managed
  AmazonVPCFullAccess	AWS managed
  AmazonRoute53FullAccess	AWS managed
  AWSCertificateManagerFullAccess
  AmazonDynamoDBFullAccess
Attach user "artem" to group "devops"

### INSTALL TERRAFORM ###
wget https://releases.hashicorp.com/terraform/0.15.2/terraform_0.15.2_linux_amd64.zip
unzip terraform_0.15.2_linux_amd64.zip
rm terraform_0.15.2_linux_amd64.zip
echo $PATH
sudo mv ./terraform /usr/local/bin/
terraform -v

### INSTALL AWS ###
curl "https://awscli.amazonaws.com/AWSCLIV2.pkg" -o "AWSCLIV2.pkg"
sudo installer -pkg AWSCLIV2.pkg -target /
aws --version
aws configure
AWS Access Key ID [None]: XXX
AWS Secret Access Key [None]: XXX
Default region name [None]: eu-central-1
Default output format [None]:

### EXPOER CREDS TO ENV ###
export AWS_ACCESS_KEY_ID=XXX
export AWS_SECRET_ACCESS_KEY=XXX

### PREPARE GIT DIRECTORY ###
vim .gitignore
.terraform
*.tfstate
*.tfstate.backup

### GENERATE KEYS PAIRS ###
aws ec2 create-key-pair\
    --key-name aws-key-pair\
    --query "KeyMaterial"\
    --output text > aws-key-pair.pem
sudo cp aws-key-pair.pem ~/.ssh/aws-key-pair.pem
sudo chmod 400  ~/.ssh/aws-key-pair.pem
rm aws-key-pair.pem

### TERRAFORM REMOTE STATE AND STATE LOCKING ###
terraform init
terraform fmt
terraform validate
terraform plan
terraform apply